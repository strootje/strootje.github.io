language: node_js
node_js: node

cache:
- npm

before_install:
# This workaround is required to avoid libstdc++ errors while running "extended" hugo with SASS support.
- wget -q -O libstdc++6 http://security.ubuntu.com/ubuntu/pool/main/g/gcc-5/libstdc++6_5.4.0-6ubuntu1~16.04.10_amd64.deb
- sudo dpkg --force-all -i libstdc++6
install:
- wget -q -O hugo.deb https://github.com/gohugoio/hugo/releases/download/v0.46/hugo_extended_0.46_Linux_64bit.deb
- sudo dpkg -i hugo.deb
- npm install

before_script:
- export LD_LIBRARY_PATH

script:
- npm run build

deploy:
  provider: pages
  repo: strootje/strootje.github.io
  github-token: $GITHUB_TOKEN
  keep-history: true
  skip-cleanup: true
  local-dir: ./public
  on:
    branch: master
